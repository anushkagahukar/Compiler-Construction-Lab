.l FILE

%{
#include <stdio.h>
#include <string.h>
#include "y.tab.h"
%}
%%
[0-9]+ { yylval.str = strdup(yytext); return NUM; }
[a-zA-Z][a-zA-Z0-9]* { yylval.str = strdup(yytext); return ID; }
[ \t] ;
\n { return '\n'; }

. { return yytext[0]; }
%%
int yywrap() { return 1; }


.y FILE

%{
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
int tempCount = 0;
char *newTemp() {
char *t = (char *)malloc(8);
sprintf(t, "t%d", ++tempCount);
return t;
}
// Prototypes
int yylex(void);
void yyerror(char *s);
%}
/* Define value type */
%union {
char *str;
}
/* Tokens with type */
%token <str> ID
%token <str> NUM
%type <str> expr
/* Operator precedence */
%left '+' '-'
%left '*' '/'
%%
stmt : expr '\n' { printf("// Final result in %s\n", $1); }
;
expr : expr '+' expr {
char *t = newTemp();
printf("%s = %s + %s\n", t, $1, $3);

$$ = t;
}
| expr '-' expr {
char *t = newTemp();
printf("%s = %s - %s\n", t, $1, $3);
$$ = t;
}
| expr '*' expr {
char *t = newTemp();
printf("%s = %s * %s\n", t, $1, $3);
$$ = t;
}
| expr '/' expr {
char *t = newTemp();
printf("%s = %s / %s\n", t, $1, $3);
$$ = t;
}
| '(' expr ')' { $$ = $2; }
| ID { $$ = strdup($1); }
| NUM { $$ = strdup($1); }
;
%%
int main() {
printf("Enter an arithmetic expression:\n");
yyparse();
return 0;
}
void yyerror(char *s) {
printf("Error: %s\n", s);
}
